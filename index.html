<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Royal Diary</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Noto+Serif+TC:wght@600&display=swap');
        
        :root {
            --ribbon-pink: #F4C2C2;
            --deep-rose: #D47381;
            --gingham: #ffe4e9;
            --glass-bg: rgba(255, 252, 249, 0.8);
            --glass-border: rgba(255, 255, 255, 0.8);
        }

        body {
            margin: 0; padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom);
            background-color: #fff;
            background-image: linear-gradient(90deg, var(--gingham) 50%, transparent 50%),
                              linear-gradient(var(--gingham) 50%, transparent 50%);
            background-size: 30px 30px;
            font-family: 'Noto Serif TC', serif;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh; color: #5a4a4a; box-sizing: border-box; overflow: hidden;
            overscroll-behavior-y: none;
        }

        .main-card {
            background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            width: 100%; max-width: 480px; height: 100%;
            padding: 15px; border-radius: 30px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 10px 30px rgba(212, 115, 129, 0.1);
            box-sizing: border-box; display: flex; flex-direction: column;
        }

        .fixed-top { flex-shrink: 0; }
        h1 { font-family: 'Dancing Script', cursive; font-size: 1.8rem; color: var(--deep-rose); margin: 0; text-align: center; }
        .quote-box { text-align: center; font-size: 0.75rem; color: #888; font-style: italic; margin-bottom: 8px; }

        .status-box {
            background: rgba(255, 255, 255, 0.5); border-radius: 18px; padding: 12px; margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.8); text-align: center;
        }
        
        .progress-bar-bg { width: 100%; height: 10px; background: rgba(255, 255, 255, 0.6); border-radius: 50px; overflow: hidden; margin: 6px 0; }
        .progress-bar-fill { height: 100%; background: linear-gradient(90deg, #FFD1DC, var(--deep-rose)); width: 0%; transition: width 1s ease; }
        
        .summary-row { display: flex; justify-content: space-around; margin-top: 8px; padding-top: 8px; border-top: 1px dashed rgba(212, 115, 129, 0.1); font-size: 0.75rem; }
        .summary-item b { display: block; font-size: 0.95rem; color: var(--deep-rose); }

        .date-container { text-align: center; margin-bottom: 8px; }
        #mainDate { border: 1.5px solid var(--ribbon-pink); border-radius: 8px; padding: 3px; font-size: 0.85rem; color: var(--deep-rose); background: white; }

        .entry-row {
            background: rgba(255, 255, 255, 0.6); padding: 8px; border-radius: 15px; margin-bottom: 8px; 
            border: 1px solid rgba(255, 255, 255, 0.9); display: flex; flex-direction: column; gap: 4px;
        }
        .row-main { display: flex; align-items: center; gap: 6px; }
        .type-select { border: 1.2px solid var(--ribbon-pink); border-radius: 8px; padding: 2px; color: var(--deep-rose); font-size: 0.75rem; }
        .input-note { flex: 1; background: transparent; border: none; border-bottom: 1.5px solid var(--ribbon-pink); outline: none; font-size: 0.9rem; }
        .input-amount { width: 80px; background: transparent; border: none; border-bottom: 1.5px solid var(--ribbon-pink); outline: none; text-align: right; font-weight: bold; color: var(--deep-rose); font-size: 1.1rem; }
        
        button:active { transform: scale(0.96); opacity: 0.8; }
        .btn-add { background: white; border: 1.5px dashed var(--deep-rose); color: var(--deep-rose); width: 100%; padding: 6px; border-radius: 12px; margin-bottom: 8px; font-size: 0.8rem; font-weight: bold; }
        .btn-save { background: linear-gradient(135deg, #FFB7B7, var(--deep-rose)); color: white; border: none; width: 100%; padding: 10px; border-radius: 50px; font-weight: 800; font-size: 1rem; }

        /* æ ¸å¿ƒå„ªåŒ–ï¼šæ»¾å‹•å€åŸŸ */
        .history-section { flex-grow: 1; overflow: hidden; display: flex; flex-direction: column; margin-top: 10px; border-top: 1px solid rgba(212, 115, 129, 0.1); }
        .history-scroll-area { overflow-y: auto; flex: 1; -webkit-overflow-scrolling: touch; padding: 5px 0; }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.5); }
        
        .settings-panel { display: none; background: white; border-radius: 20px; padding: 15px; position: absolute; z-index: 100; width: 92%; left: 4%; top: 40px; border: 1px solid var(--ribbon-pink); max-height: 85vh; overflow-y: auto; box-sizing: border-box; }
    </style>
</head>
<body>
    <div class="main-card">
        <div class="fixed-top">
            <div style="display:flex; justify-content: space-between; align-items: center;">
                <span style="font-size: 1.2rem;">ğŸ€</span>
                <button onclick="toggleSettings()" style="background:none; border:none; color:var(--deep-rose); font-size: 1.3rem;">âš™ï¸</button>
            </div>
            <div id="settingsPanel" class="settings-panel">...</div>
            <h1>Royal Diary</h1>
            <div id="dailyQuote" class="quote-box"></div>
            <div class="status-box">
                <p id="wishTitle" style="font-weight: 800; color: var(--deep-rose); margin:0; font-size: 0.9rem;">å°é­è¨ˆç•«</p>
                <div class="progress-bar-bg"><div id="progressFill" class="progress-bar-fill"></div></div>
                <p style="margin:0; font-size:0.8rem;">é”æˆ <span id="percentText" style="color:var(--deep-rose);">0</span>% ($<span id="currentText">0</span> / $<span id="goalText">0</span>)</p>
                <div class="summary-row">
                    <div class="summary-item">ç´¯ç©å­˜å…¥<b id="totalIn">$0</b></div>
                    <div class="summary-item">ç´¯ç©æ”¯å‡º<b id="totalOut">$0</b></div>
                </div>
            </div>
            <div class="date-container"><input type="date" id="mainDate"></div>
            <div id="inputArea">
                <div class="entry-row">
                    <div class="row-main">
                        <select class="type-select"><option value="in">ğŸ’– å­˜å…¥</option><option value="out">ğŸ’¸ æ”¯å‡º</option></select>
                        <input type="text" class="input-note" placeholder="è¨˜éŒ„ä»Šæ—¥å°ç¢ºå¹¸...">
                        <button style="background:none; border:none; color:#FFB7B7; font-size:1.2rem;" onclick="removeRow(this)">Ã—</button>
                    </div>
                    <div class="row-amount"><span style="color:var(--deep-rose);font-weight:bold;">$</span><input type="number" class="input-amount" placeholder="0" inputmode="decimal"></div>
                </div>
            </div>
            <button class="btn-add" onclick="addNewRow()">ï¼‹ å¢åŠ æ˜ç´°</button>
            <button class="btn-save" onclick="saveEntries()">å¯«å…¥æ˜ç´°ç´€éŒ„ âœ¨</button>
        </div>

        <div class="history-section">
            <div id="historyList" class="history-scroll-area"></div>
        </div>
        
        <button onclick="resetData()" style="color:#eee; border:none; background:none; font-size:8px; margin-top:5px; opacity: 0.5;">RESET</button>
    </div>
    </body>
</html>
